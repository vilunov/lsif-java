/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
    id 'application'
    id "com.palantir.graal" version "0.7.1-14-g8d28394"
}

application {
    mainClassName = 'lsifjava.Main'
}

repositories {
    mavenLocal()
    maven {
        url = 'https://repo.maven.apache.org/maven2'
    }
}

dependencies {
    compile 'com.github.javaparser:javaparser-symbol-solver-core:3.16.1'
    compile 'fr.inria.gforge.spoon:spoon-core:8.4.0-SNAPSHOT'
    /* compile 'fr.inria.gforge.spoon:spoon-core:8.3.0-beta-8' */
    compile 'com.google.code.gson:gson:2.8.6'
    compile 'commons-cli:commons-cli:1.4'
    compile 'org.slf4j:slf4j-api:1.7.30'
    compile 'org.slf4j:slf4j-nop:1.7.30'
}

group = 'com.sourcegraph'
version = '1.0-SNAPSHOT'
sourceCompatibility = '1.8'

publishing {
    model {
        tasks.generatePomFileForSourcegraphPublication {
            destination = file("$projectDir/pom.xml")
        }
    }
    publications {
        sourcegraph(MavenPublication) {
            from components.java
        }
    }
}

graal {
    mainClass 'Main'
    outputName 'lsif-java'
    graalVersion '20.2.0'
    option '--static'
    option '--no-fallback'
    option '--initialize-at-build-time'
    option '--initialize-at-run-time=""'
    option '-H:IncludeResourceBundles=org.eclipse.jdt.internal.compiler.batch.messages'
    option '-H:IncludeResourceBundles=org.eclipse.jdt.internal.compiler.problem.messages'
    option '-H:ReflectionConfigurationFiles=reflectconfig.json'
}
